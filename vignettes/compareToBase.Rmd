---
title: "From base R"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{From base R}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

```{r, echo = FALSE, message = FALSE}
knitr::opts_chunk$set(collapse = T, comment = "#>")
options(tibble.print_min = 5)
library(dplyr)
```

This vignette aims to compare dplyr functions to base R equivalents to facilitate users transitioning from using base R to dplyr. 

# One input

| base | dplyr    |
|------|------------|
|   `df[order(x), , drop = FALSE]`   | `arrange(df, x)` |
|   `df[!duplicated(x), , drop = FALSE]`, `unique()`   | `distinct(df, x)`  |
|   `df[x & !is.na(x), , drop = FALSE]`, `subset()`   | `filter(df, x)`  |
|   `df$z <- df$x + df$y`, `transform()`   | `mutate(df, z = x + y)`  |
|   `df$x`    | `pull(df, x)` |
|   N/A   | `rename(df, y = x)` |
|   `df[c("x", "y")]`, `subset()`  | `select(df, x, y)` |
|   `df[grepl(names(df), "^x")]` | `select(df, starts_with("x")` |
|   `mean(df$x)` | `summarise(df, mean(x))` |
|   `df[c(1, 2, 5), , drop = FALSE]` | `slice(df, c(1, 2, 5))` |

# Two inputs

| base | dplyr    |
|------|------------|
|   `merge(df1, df2)`   | `inner_join(df1, df2)` |
|   `merge(df1, df2, all.x = TRUE)`   | `left_join(df1, df2) `  |
|   ` merge(df1, df2, all.y = TRUE)`   | `right_join(df1, df2)`  |
|   `merge(df1, df2, all = TRUE)`   | `full_join(df1, df2)`  |
|   `df1[df1$x %in% df2$x, , drop = FALSE]`    | `semi_join(df1, df2)` |
|   `df1[!df1$x %in% df2$x, , drop = FALSE]` | `anti_join(df1, df2)` |

Overall the main differences between base R and dplyr are:



These dplyr examples come from the [dplyr documentation](https://cran.r-project.org/web/packages/dplyr/dplyr.pdf) and here, they are contrasted with the analogous base R operation(s).
# One thing

## `arrange()`: Arrange rows by variables

```{r}
# base
mtcars[order(mtcars$cyl, mtcars$disp), ,drop = F] %>% head()

# dplyr
arrange(mtcars, cyl, disp) %>% head()
```

## `distinct()`: Select distinct/unique rows

```{r}
df <- tibble(
  x = sample(10, 100, rep = TRUE),
  y = sample(10, 100, rep = TRUE)
)

# base
df[!duplicated(df$x), , drop = F] # whole dataframe
unique(df$x) # just the values


# dplyr
distinct(df, x)
```

## `filter()`: Return rows with matching conditions

```{r}
# base
subset(starwars, species == "Human")
subset(starwars, mass > 1000)
subset(starwars, hair_color == "none" & eye_color == "black")

# dplyr

filter(starwars, species == "Human")
filter(starwars, mass > 1000)
filter(starwars, hair_color == "none" & eye_color == "black")
```

## `mutate()`: Create or transform variables

```{r}
# base
mtcars$cyl2 <- mtcars$cyl * 2
mtcars$cyl4 <- mtcars$cyl2 * 2

# dplyr
mtcars %>%
  as_tibble() %>%
  mutate(
    cyl2 = cyl * 2,
    cyl4 = cyl2 * 2
  )
```

## `pull()`: Pull out a single variable

```{r}
# base
mtcars[,1]
mtcars$cyl

# dplyr
mtcars %>% pull(1)
mtcars %>% pull(cyl)
```

## `rename()`: Rename variables by name

```{r}
iris_copy = iris
# base
change_idx <- grep(pattern = "Petal.Length", names(iris))
names(iris)[change_idx] <- "petal_length"

# dplyr
rename(iris_copy, petal_length = Petal.Length) %>% head()
```

## `select()`: Select variables by name

```{r}
# base
iris[, c("Species", "Petal.Width")] %>% head()
iris[, grepl("^x", names(iris))] %>% head()

# dplyr
select(iris, Species, Petal.Width) %>% head()
select(iris, starts_with("Sepal")) %>% head()
```

## `summarise()`: Reduce multiple values down to a single value

```{r}
# base
mean(mtcars$disp)
nrow(mtcars$disp)

# dplyr
mtcars %>%
  summarise(mean = mean(disp), n = n())
```

## `slice()`: Choose rows by position

```{r}
# base
mtcars[25:nrow(mtcars), ]

# dplyr
slice(mtcars, 25:n())
```

# Merge --> Join

## `inner_join()`: Join two tables together

```{r}
# base
merge(band_members, band_instruments, by.x = "name", by.y = "name", all.x = F, all.y = F)

# dplyr
band_members %>% inner_join(band_instruments)
```

## `left_join()`: Join two tables together

```{r}
# base
merge(band_members, band_instruments, by.x = "name", by.y = "name", all.x = T, all.y = F)

# dplyr
band_members %>% left_join(band_instruments)
```

## `right_join()`: Join two tables together

```{r}
# base
merge(band_members, band_instruments, by.x = "name", by.y = "name", all.x = F, all.y = T)

# dplyr
band_members %>% right_join(band_instruments)
```

## `full_join()`: Join two tables together

```{r}
# base
merge(band_members, band_instruments, by.x = "name", by.y = "name", all.x = T, all.y = T)

# dplyr
band_members %>% full_join(band_instruments)
```

## `semi_join()`: Join two tables together

return all rows from `x` where there are matching values in `y`

only returns columns from `x`

```{r}
# base
band_members[band_members$name %in% band_instruments$name, , drop = FALSE]

# dplyr
band_members %>% semi_join(band_instruments)
```

## `anti_join()`: Join two tables together

return all rows from `x` where are not matching values in `y`

only returns columsn from `x`

```{r}
# base
band_members[!band_members$name %in% band_instruments$name, , drop = FALSE]

# dplyr
band_members %>% anti_join(band_instruments)
```

